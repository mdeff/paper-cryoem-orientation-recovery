\section{Discussion}\label{sec:discussion}

% Summary.
In this work, we explored the use of distance learning between pairs of 2D cryo-EM projections from a 3D protein structure to infer the unknown orientation at which each projection was imaged from.
Our two-step method relies on the training of a SiameseNN to estimate pairwise distances between unseen projections, followed by the recovery of the orientations from these distances through an appropriate minimization scheme.

The benefit of this approach, at least in theory, is that it would permit to estimate the unknown orientations in single-particle cryo-EM directly from the acquired dataset, \ie, without the need for intermediate reconstruction procedure or initial volume estimate; this has obvious attractive implications in the field.

At the current stage of development, the method has been evaluated on synthetic datasets for two different proteins.
The results provide key insights on the viability of the proposed scheme.
First, they demonstrate that a SiameseNN can learn a distance function between projections that estimates the difference in their orientation (\secref{results:distance-estimation:learned}) and that is invariant to off-centering shifts and robust to increasing levels of noise (\secref{results:distance-estimation:sensitivity})---an important condition in cryo-EM\@.
%\mdeff{The two phrases in the following sentence sound redundant.}
Second, they guarantee that an accurate distance estimation leads to a correct recovery of the orientations. % , while providing indications that the quality of this recovery depends on the precision of the estimated distances (\secref{results:orientation-recovery:sensitivity}, \secref{results:distance-estimation:sensitivity}).
Finally, our method was able to recover orientations with an error of \banjac{$0.12$ to $0.19$ radians ($6$ to $11\degree$) from noiseless and $0.13$ to $0.25$ radians ($7$ to $14$\degree) from noisy projections}---leading to an initial \todo{volume/reconstruction} with a resolution of \banjac{$8.0$ to $9.6$\AA\ for the symmetric protein, and $12.2$ to $15.2$\AA\ for the asymmetric protein when the FSC is $0.5$} \mdeff{or ``with a resolution 4x worse that the ground-truth?''} (\secref{results:orientation-recovery:reconstruction}).
In summary, the more accurate the estimated distances, the more precise the recovery of the orientations, and, ultimately, the better the reconstructed volume.

% Future work.
While the method is not yet at the stage where it can be deployed in practice, we believe that a series of developments could help it become a more relevant contributor for single-particle cryo-EM reconstruction.%
\footnote{Note that the present project will not be further continued by its authors due to other professional occupations. Hence, we strongly encourage anyone interested to build on these ideas and, hopefully, make it a practical tool.}
As previously discussed, the results underline the importance of learning an accurate distance estimator. % $\widehat{d_p}$.
In this regard, the performance of the SiameseNN could be improved in several ways.
% Method gains: mostly distance learning maybe recovery (not alignment).
%A set of additional technical developments could also further improve performance.
First, the architecture of the SiameseNN's twin CNNs should be expanded and tuned.
% While it gave good performance for a reasonable runtime, it could be optimized.
% , as well as the distance metric between the two CNN outputs.
% For instance, one could parametrize the function $d_f$---which compares the similarity of the features outputs (see \figref{schematic:distance-learning})---as a feed-forward neural network instead of the current Euclidean distance, and learn its weights as well.
Second, the training of the SiameseNN could be improved, perhaps by providing more supervision by separately predicting the differences in direction $(\theta_2,\theta_1)$ and in-plane angle $\theta_3$.
\todo{It can definitely learn mirroring / full coverage, albeit not as well as half (because it doesn't exploit that symmetry). Motivation to incorporate this physical knowledge into the NN architecture. Motivation (on top of half in-plane being much easier for 5a1a) to predict the direction and in-plane angle separately.}

% \mdeff{Let's ignore improvements to recovery and concentrate the story on better distance learning -> better recovery -> better reconstruction.}
%Among others, one shall explore whether reducing the influence of larger distances in orientation recovery could bring further gain in accuracy.
% \mdeff{The following are issues with alignment---not directly related to our method---that we mentioned elsewhere.}
% Angle alignment didn't always work, even when $L_\text{OR}$ was low (examples?): We might miss a transformation in \eqnref{orientation-recovery-error}.
% Why did we need to align with \eqnref{orientation-recovery-error} before reconstructing with ASTRA\@?

% Data gains.
Importantly, the SiameseNN would be better trained on a more exhaustive and diverse cryo-EM dataset.
Indeed, the success of the SiameseNN as a faithful estimator of relative orientations eventually relies on our capacity to generate a synthetic training dataset whose data distribution is diverse enough to cover that of unseen projection datasets.
Such realistic cryo-EM projections could be generated by relying on a more expressive formulation of the cryo-EM physics and taking advantage of the thousands of atomic models available in the PDB\@.
% \mdeff{PDB database sounds redundant as PDB stands for protein database.}
In particular, a necessary extension will be to include the effects of the PSF when generating training data and evaluate its impact on the SiameseNN\@. % like we did for shifts and noise

% Towards practical use: unseen proteins (also data) and real measurements.
% A final phase of tests before deploying the method on real cryo-EM measurements will be to extensively test the method on ``unseen proteins'', \ie, proteins whose simulated projections have never been seen by the SiameseNN\@.
% Early experiments indicate the feasibility of this enterprise (see \apxref{unseen-proteins}).
% In this regard, an interesting aspect of our method is that the twin CNNs within the SiameseNN intrinsically predict the \textit{relationship} between projections, allowing the SiameseNN as a whole to abstract the particular volume.
% %Consequently, a well-trained distance estimator could be relatively robust to the ``mismatch'' of volumes within the training set.
% %In the same line of thought,
% Learning benefits from the profound structural similarity shared by proteins---after all, they are all derived from the same $21$ building blocks.
% \todo{remove Appendix \apxref{unseen-proteins}}
% Learning exploits statistical effects, given here by biological building block.

% \mdeff{I propose to omit the following sentence (which is a truism and is stated in the previous paragraph) to finish on a more forceful note.}
% Eventually, the performance of the method on real cryo-EM measurements will provide the real measure of its potential, the imaging conditions being notoriously challenging in single-particle cryo-EM\@.
% Further down the line and still in the real of the hypothetical, new approaches for the training of the SiameseNN able to handle the handling of proteins with multiple conformational states could be explored.
